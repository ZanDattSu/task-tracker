**Task Tracker** — это Java‑pet-проект для управления задачами через HTTP API и веб-интерфейс. Он демонстрирует работу с REST-сервисом на Java, сохранение состояния менеджера задач в JSON через HTTP-сервер и кастомную (de)сериализацию Java 11 Date/Time API.

**Ключевые особенности**

* CRUD-операции для задач, эпиков и подзадач.
* HTTP API для получения, создания, обновления и удаления задач.
* Хранение состояния менеджера (`HTTPTaskManager`) в JSON-файле через встроенный HTTP-сервер.
* Реализация кастомного GSON-адаптера (`LocalDateTimeAdapter`) для сериализации и десериализации `LocalDateTime`.
* Поддержка истории просмотров задач.
* Написаны тесты на JUnit5.

---

## Архитектура проекта

### 1. Модель данных (Domain Layer)

Классы, описывающие сущности задачи:

* **`Task`**: Базовая задача с полями: `id`, `название`, `описание`, `статус` (enum `Status`), `дата начала`, `продолжительность`.
* **`Epic`**: Эпик (составная задача), наследует `Task`, добавляет список подзадач (`subtasks`).
* **`Subtask`**: Подзадача, наследует `Task`, содержит ссылку на эпик (`epicId`).

---

### 2. Менеджеры задач (Business Logic Layer)

Отвечают за бизнес-логику: создание, обновление, удаление задач, управление историей.

* **`TaskManager`** (интерфейс):

    * Определяет CRUD-операции для задач, эпиков и подзадач.
    * Управление приоритетом задач (на основе времени начала).
* **`HTTPTaskManager`** (реализация):

    * Сохраняет состояние задач через HTTP-сервер (KVServer) с использованием `KVTaskClient`.
    * Сериализует/десериализует данные в JSON с помощью `GsonProvider`.
* **`HistoryManager`** (интерфейс) и `InMemoryHistoryManager` (реализация):

    * Сохраняет историю просмотров задач (GET-запросы по ID).
    * Обеспечивает методы для добавления, удаления и получения истории.

---

### 3. HTTP-сервер и обработчики (API Layer)

Обработка REST-запросов и маршрутизация:

* **`HttpTaskServer`**:

    * Запускает HTTP-сервер (`com.sun.net.httpserver.HttpServer`).
    * Регистрирует обработчики для эндпоинтов: `/tasks/task`, `/tasks/subtask`, `/tasks/epic`, `/tasks/history`.
* **Обработчики** (наследуют `ServerHandler`):

    * `TaskHandler`, `SubtaskHandler`, `EpicHandler`: реализуют логику для GET/POST/DELETE.
    * `SubtasksOfEpidHandler`: возвращает подзадачи эпика.
    * `HistoryHandler`: управляет историей просмотров.
    * `PrioritizedHandler`: возвращает задачи, упорядоченные по приоритету.

---

### 4. Сериализация и утилиты (Infrastructure Layer)

* **`GsonProvider`**:

    * Настраивает GSON с кастомным адаптером `LocalDateTimeAdapter` для работы с `java.time.LocalDateTime`.
* **`KVTaskClient`** и **`KVServer`**:

    * Клиент-серверное взаимодействие для сохранения состояния задач.
    * `KVServer` выступает как key-value хранилище (например, для JSON-данных).
* **Утилиты**:

    * `TaskTimeValidator`: проверяет корректность времени задач.
    * `TimeCalculator`: вычисляет время завершения задач и эпиков.

---

### 5. Точка входа и запуск

* **`Main`**:

    * Запускает `KVServer` (если требуется) и `HttpTaskServer`.
    * Инициализирует менеджеры через фабрику `Managers.getDefault()` (возвращает `HTTPTaskManager` и `InMemoryHistoryManager`).

---

**Технологии**

* Java 11+
* GSON для JSON (десериализация/сериализация)
* Java HTTP Server (`com.sun.net.httpserver.HttpServer`)
* Java Date & Time API (`java.time`)
* JUnit 5

---

## HTTP API

* `GET /tasks` — вернуть все задачи (task, subtask, epic) упорядоченные по приоритету (времени начала).
* `DELETE /tasks` — удалить все задачи, подзадачи и эпики.

**Работа с задачами** (`/tasks/task`)

* `GET /tasks/task` — получить список всех задач.
* `GET /tasks/task?id={id}` — получить задачу по её идентификатору.
* `POST /tasks/task` — создать новую задачу или обновить существующую (JSON в теле запроса).
* `DELETE /tasks/task` — удалить все задачи.
* `DELETE /tasks/task?id={id}` — удалить задачу по идентификатору (возвращает удалённую задачу в теле ответа).

**Работа с подзадачами** (`/tasks/subtask`)

* `GET /tasks/subtask` — получить список всех подзадач.
* `GET /tasks/subtask?id={id}` — получить подзадачу по её идентификатору.
* `POST /tasks/subtask` — создать новую подзадачу или обновить существующую (JSON в теле запроса).
* `DELETE /tasks/subtask` — удалить все подзадачи.
* `DELETE /tasks/subtask?id={id}` — удалить подзадачу по идентификатору (возвращает удалённую подзадачу в теле ответа).
* `GET /tasks/subtask/epic?id={id}` — получить все подзадачи эпика с указанным идентификатором.

**Работа с эпиками** (`/tasks/epic`)

* `GET /tasks/epic` — получить список всех эпиков.
* `GET /tasks/epic?id={id}` — получить эпик по его идентификатору.
* `POST /tasks/epic` — создать новый эпик или обновить существующий (JSON в теле запроса).
* `DELETE /tasks/epic` — удалить все эпики.
* `DELETE /tasks/epic?id={id}` — удалить эпик по идентификатору (возвращает удалённый эпик в теле ответа).

**История просмотров**

* `GET /tasks/history` — получить историю просмотров задач.
* `DELETE /tasks/history` — очистить историю просмотров.

*\*Под просмотром понимается любой вызов GET `/tasks/task?id={id}`, `/tasks/subtask?id={id}` или `/tasks/epic?id={id}`.*
